<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# sigma

```go
import "Alterix/sigma"
```

## Index

- [func FuzzConditionParser(data []byte) int](<#func-fuzzconditionparser>)
- [func FuzzConfigParser(data []byte) int](<#func-fuzzconfigparser>)
- [func FuzzRuleParser(data []byte) int](<#func-fuzzruleparser>)
- [type AggregationExpr](<#type-aggregationexpr>)
- [type AggregationFunc](<#type-aggregationfunc>)
- [type AllOfIdentifier](<#type-allofidentifier>)
- [type AllOfPattern](<#type-allofpattern>)
- [type AllOfThem](<#type-allofthem>)
- [type And](<#type-and>)
- [type Average](<#type-average>)
- [type Comparison](<#type-comparison>)
- [type ComparisonOp](<#type-comparisonop>)
- [type Condition](<#type-condition>)
  - [func ParseCondition(input string) (Condition, error)](<#func-parsecondition>)
  - [func (c Condition) MarshalYAML() (interface{}, error)](<#func-condition-marshalyaml>)
- [type Conditions](<#type-conditions>)
  - [func (c Conditions) MarshalYAML() (interface{}, error)](<#func-conditions-marshalyaml>)
  - [func (c *Conditions) UnmarshalYAML(node *yaml.Node) error](<#func-conditions-unmarshalyaml>)
- [type Config](<#type-config>)
  - [func ParseConfig(contents []byte) (Config, error)](<#func-parseconfig>)
- [type Count](<#type-count>)
- [type Detection](<#type-detection>)
- [type EventMatcher](<#type-eventmatcher>)
  - [func (f EventMatcher) MarshalYAML() (interface{}, error)](<#func-eventmatcher-marshalyaml>)
  - [func (f *EventMatcher) UnmarshalYAML(node *yaml.Node) error](<#func-eventmatcher-unmarshalyaml>)
- [type FieldMapping](<#type-fieldmapping>)
  - [func (f *FieldMapping) UnmarshalYAML(value *yaml.Node) error](<#func-fieldmapping-unmarshalyaml>)
- [type FieldMatcher](<#type-fieldmatcher>)
- [type FileType](<#type-filetype>)
  - [func InferFileType(contents []byte) FileType](<#func-inferfiletype>)
  - [func (f *FileType) UnmarshalYAML(node *yaml.Node) error](<#func-filetype-unmarshalyaml>)
- [type Logsource](<#type-logsource>)
- [type LogsourceIndexes](<#type-logsourceindexes>)
  - [func (i *LogsourceIndexes) UnmarshalYAML(value *yaml.Node) error](<#func-logsourceindexes-unmarshalyaml>)
- [type LogsourceMapping](<#type-logsourcemapping>)
- [type Max](<#type-max>)
- [type Min](<#type-min>)
- [type Near](<#type-near>)
- [type Not](<#type-not>)
- [type OneOfIdentifier](<#type-oneofidentifier>)
- [type OneOfPattern](<#type-oneofpattern>)
- [type OneOfThem](<#type-oneofthem>)
- [type Or](<#type-or>)
- [type RelatedRule](<#type-relatedrule>)
- [type Rule](<#type-rule>)
  - [func ParseRule(input []byte) (Rule, error)](<#func-parserule>)
- [type Search](<#type-search>)
  - [func (s Search) MarshalYAML() (interface{}, error)](<#func-search-marshalyaml>)
  - [func (s *Search) UnmarshalYAML(node *yaml.Node) error](<#func-search-unmarshalyaml>)
- [type SearchExpr](<#type-searchexpr>)
- [type SearchIdentifier](<#type-searchidentifier>)
- [type Sum](<#type-sum>)


## func [FuzzConditionParser](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/fuzz.go#L13>)

```go
func FuzzConditionParser(data []byte) int
```

Try parsing the input data as a Sigma condition\, return 0 if it fails \(no match\)\, 1 otherwise \(match\)

## func [FuzzConfigParser](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/fuzz.go#L22>)

```go
func FuzzConfigParser(data []byte) int
```

Try parsing the input data as a Sigma config file\, return 0 if it fails \(no match\)\, 1 otherwise \(match\)

## func [FuzzRuleParser](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/fuzz.go#L4>)

```go
func FuzzRuleParser(data []byte) int
```

Try parsing the input data as a Sigma rule\, return 0 if it fails \(no match\)\, 1 otherwise \(match\)

## type [AggregationExpr](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L187-L190>)

Define the AggregationExpr interface with two methods\.

```go
type AggregationExpr interface {
    // contains filtered or unexported methods
}
```

## type [AggregationFunc](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L236-L239>)

AggregationFunc is an interface for defining aggregation functions\.

```go
type AggregationFunc interface {
    // contains filtered or unexported methods
}
```

## type [AllOfIdentifier](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L110-L112>)

AllOfIdentifier is a struct representing a search expression that matches documents containing all of the specified identifiers\.

```go
type AllOfIdentifier struct {
    Ident SearchIdentifier
}
```

## type [AllOfPattern](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L125-L127>)

AllOfPattern defines a struct that represents a search query for all occurrences of a given pattern

```go
type AllOfPattern struct {
    Pattern string
}
```

## type [AllOfThem](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L162>)

AllOfThem is a struct that represents a search expression for all of the items matching the search criteria\.

```go
type AllOfThem struct{}
```

## type [And](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L36>)

And is a type that represents a list of search expressions that are connected with the "and" operator\.

```go
type And []SearchExpr
```

## type [Average](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L300-L303>)

Average represents an aggregation function that calculates the average of a field\.

```go
type Average struct {
    Field     string // The field to be averaged.
    GroupedBy string // Optional field to group the results by.
}
```

## type [Comparison](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L221-L225>)

Comparison represents a comparison expression that applies a comparison operator to an aggregation result

```go
type Comparison struct {
    Func      AggregationFunc // the aggregation function to apply
    Op        ComparisonOp    // the comparison operator to use
    Threshold float64         // the threshold value to compare against
}
```

## type [ComparisonOp](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L208>)

ComparisonOp represents the comparison operators used in comparisons

```go
type ComparisonOp string
```

Define the different comparison operators as constants

```go
var (
    Equal            ComparisonOp = "="
    NotEqual         ComparisonOp = "!="
    LessThan         ComparisonOp = "<"
    LessThanEqual    ComparisonOp = "<="
    GreaterThan      ComparisonOp = ">"
    GreaterThanEqual ComparisonOp = ">="
)
```

## type [Condition](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L10-L13>)

```go
type Condition struct {
    Search      SearchExpr      // represents the search query
    Aggregation AggregationExpr // represents the aggregation operation
}
```

### func [ParseCondition](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/condition_parser.go#L31>)

```go
func ParseCondition(input string) (Condition, error)
```

Parses the Sigma condition syntax and returns a Condition struct and/or an error

### func \(Condition\) [MarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L17>)

```go
func (c Condition) MarshalYAML() (interface{}, error)
```

This function is used to convert a Condition struct to YAML format\. It takes the Condition struct and returns its YAML representation\.

## type [Conditions](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L52>)

```go
type Conditions []Condition
```

### func \(Conditions\) [MarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L90>)

```go
func (c Conditions) MarshalYAML() (interface{}, error)
```

MarshalYAML marshals the Conditions slice to YAML\.

### func \(\*Conditions\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L55>)

```go
func (c *Conditions) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML unmarshals the YAML node to the Conditions slice\.

## type [Config](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L8-L17>)

Config is a struct that defines the Sigma configuration

```go
type Config struct {
    Title         string   // A short description of what this configuration does
    Order         int      // Defines the order of expansion when multiple config files are applicable
    Backends      []string // Lists the Sigma implementations that this config file is compatible with
    FieldMappings map[string]FieldMapping
    Logsources    map[string]LogsourceMapping
    // TODO: LogsourceMerging option
    DefaultIndex string                   // Defines a default index if no logsources match
    Placeholders map[string][]interface{} // Defines values for placeholders that might appear in Sigma rules
}
```

### func [ParseConfig](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L75>)

```go
func ParseConfig(contents []byte) (Config, error)
```

ParseConfig takes a byte slice of YAML data and returns a Config struct or an error if unmarshaling fails

## type [Count](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L242-L245>)

Count represents a count aggregation function\.

```go
type Count struct {
    Field     string // the field to count
    GroupedBy string // the field to group by
}
```

## type [Detection](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L46-L50>)

```go
type Detection struct {
    Searches   map[string]Search `yaml:",inline"`    // Searches holds a map of search query strings and their corresponding configurations.
    Conditions Conditions        `yaml:"condition"`  // Conditions holds a slice of conditions to be checked for the detection to occur.
    Timeframe  time.Duration     `yaml:",omitempty"` // Timeframe specifies the time duration within which the detection must occur.
}
```

## type [EventMatcher](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L159>)

```go
type EventMatcher []FieldMatcher
```

### func \(EventMatcher\) [MarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L183>)

```go
func (f EventMatcher) MarshalYAML() (interface{}, error)
```

MarshalYAML returns a YAML representation of the EventMatcher struct

### func \(\*EventMatcher\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L162>)

```go
func (f *EventMatcher) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML parses the YAML node and sets the fields on the EventMatcher struct

## type [FieldMapping](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L20-L23>)

FieldMapping is a struct that defines the target fields to be matched in Sigma rules

```go
type FieldMapping struct {
    TargetNames []string // The name(s) that appear in the events being matched

}
```

### func \(\*FieldMapping\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L26>)

```go
func (f *FieldMapping) UnmarshalYAML(value *yaml.Node) error
```

UnmarshalYAML is a custom method for unmarshaling YAML data into FieldMapping

## type [FieldMatcher](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L206-L210>)

FieldMatcher defines a matcher for a single field

```go
type FieldMatcher struct {
    Field     string
    Modifiers []string
    Values    []interface{}
}
```

## type [FileType](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_or_config.go#L19>)

FileType represents the type of a Sigma file

```go
type FileType string
```

Possible file types

```go
const (
    UnknownFile FileType = ""        // Unknown file type
    InvalidFile FileType = "invalid" // Invalid file type
    RuleFile    FileType = "rule"    // Sigma rule file type
    ConfigFile  FileType = "config"  // Sigma config file type
)
```

### func [InferFileType](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_or_config.go#L10>)

```go
func InferFileType(contents []byte) FileType
```

InferFileType attempts to infer the type of Sigma file by unmarshalling the YAML contents and checking if it contains certain required fields for a rule or config file\. If there is an error unmarshalling the contents\, it returns an invalid file type\.

### func \(\*FileType\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_or_config.go#L32>)

```go
func (f *FileType) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML is a custom unmarshaller for the FileType type\. It checks if the YAML node contains certain required fields for a rule or config file\, and sets the corresponding FileType value\.

## type [Logsource](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L36-L44>)

```go
type Logsource struct {
    Category   string `yaml:",omitempty"` // The category of the log source
    Product    string `yaml:",omitempty"` // The product associated with the log source
    Service    string `yaml:",omitempty"` // The service associated with the log source
    Definition string `yaml:",omitempty"` // The definition of the log source

    // Any non-standard fields will end up in here
    AdditionalFields map[string]interface{} `yaml:",inline"` // Any additional fields in the YAML document
}
```

## type [LogsourceIndexes](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L53>)

LogsourceIndexes is a list of strings representing indexes for a logsource

```go
type LogsourceIndexes []string
```

### func \(\*LogsourceIndexes\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L56>)

```go
func (i *LogsourceIndexes) UnmarshalYAML(value *yaml.Node) error
```

UnmarshalYAML is a custom method for unmarshaling YAML data into LogsourceIndexes

## type [LogsourceMapping](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/config_parser.go#L45-L50>)

LogsourceMapping defines the mapping between a logsource and its indexes\, conditions\, and rewrites

```go
type LogsourceMapping struct {
    Logsource  `yaml:",inline"` // A LogsourceMapping embeds the Logsource struct, which defines a set of fields that can be matched in Sigma rules
    Index      LogsourceIndexes // The index(es) that should be used for this logsource
    Conditions Search           // Conditions that are added to all rules targeting this logsource
    Rewrite    Logsource        // Rewrites this logsource (i.e. so that it can be matched by another lower precedence config)
}
```

## type [Max](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L280-L283>)

Max is a type that represents a maximum aggregation function\.

```go
type Max struct {
    Field     string // The field to apply the max function to.
    GroupedBy string // The field to group the results by.
}
```

## type [Min](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L260-L263>)

Min represents the minimum aggregation function\.

```go
type Min struct {
    Field     string // Field to apply the aggregation on
    GroupedBy string // Optional field to group the aggregation by
}
```

## type [Near](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L193-L195>)

Define the Near struct with a Condition field\.

```go
type Near struct {
    Condition SearchExpr
}
```

## type [Not](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L81-L83>)

Not struct represents a negation of a search expression\.

```go
type Not struct {
    Expr SearchExpr // The search expression to be negated.
}
```

## type [OneOfIdentifier](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L95-L97>)

OneOfIdentifier represents an expression that matches one of the search identifiers\.

```go
type OneOfIdentifier struct {
    Ident SearchIdentifier
}
```

## type [OneOfPattern](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L138-L140>)

OneOfPattern represents a search expression that matches one of the search patterns\.

```go
type OneOfPattern struct {
    Pattern string
}
```

## type [OneOfThem](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L151>)

OneOfThem is a struct representing a search expression that matches if exactly one search result is matched\.

```go
type OneOfThem struct{}
```

## type [Or](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L58>)

Or is a slice of SearchExpr representing a logical "or" operation between multiple search expressions\.

```go
type Or []SearchExpr
```

## type [RelatedRule](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L31-L34>)

```go
type RelatedRule struct {
    ID   string // The unique ID of the related rule
    Type string // The type of the related rule (e.g. "similar", "correlated", "superseded")
}
```

## type [Rule](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L11-L29>)

```go
type Rule struct {
    // Required fields
    Title     string    // The title of the Sigma rule
    Logsource Logsource // The log source that the rule should be applied to
    Detection Detection // The detection logic of the rule

    // Optional fields
    ID          string        `yaml:",omitempty"` // The unique ID of the rule
    Related     []RelatedRule `yaml:",omitempty"` // Related rules, if any
    Status      string        `yaml:",omitempty"` // The status of the rule (e.g. "testing", "production")
    Description string        `yaml:",omitempty"` // A brief description of the rule
    Author      string        `yaml:",omitempty"` // The author of the rule
    Level       string        `yaml:",omitempty"` // The severity level of the rule (e.g. "low", "medium", "high")
    References  []string      `yaml:",omitempty"` // References related to the rule
    Tags        []string      `yaml:",omitempty"` // Tags that can be used to organize the rules

    // Any non-standard fields will end up in here
    AdditionalFields map[string]interface{} `yaml:",inline"` // Any additional fields in the YAML document
}
```

### func [ParseRule](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L270>)

```go
func ParseRule(input []byte) (Rule, error)
```

ParseRule reads a byte slice and returns a parsed Rule object and an error \(if any\)

## type [Search](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L99-L102>)

Search defines a search criteria that can be used to match events\.

```go
type Search struct {
    Keywords      []string       // Keywords to search for
    EventMatchers []EventMatcher // List of event matchers (maps of fields to values)
}
```

### func \(Search\) [MarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L138>)

```go
func (s Search) MarshalYAML() (interface{}, error)
```

MarshalYAML encodes the Search object into a YAML representation\.

### func \(\*Search\) [UnmarshalYAML](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/rule_parser.go#L105>)

```go
func (s *Search) UnmarshalYAML(node *yaml.Node) error
```

UnmarshalYAML decodes the YAML representation of a Search object\.

## type [SearchExpr](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L30-L33>)

SearchExpr is an interface that represents a search expression\.

```go
type SearchExpr interface {
    // contains filtered or unexported methods
}
```

## type [SearchIdentifier](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L173-L175>)

SearchIdentifier represents a search identifier\, which is simply a string\.

```go
type SearchIdentifier struct {
    Name string // The name of the identifier.
}
```

## type [Sum](<https://github.com/mtnmunuklu/Alterix/blob/main/sigma/ast.go#L318-L321>)

The Sum type represents an aggregation function that calculates the sum of a field\.

```go
type Sum struct {
    Field     string // The name of the field to sum.
    GroupedBy string // The name of the field to group by, if any.
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
